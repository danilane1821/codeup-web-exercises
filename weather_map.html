<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Weather Map</title>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.2.1/mapbox-gl.css' rel='stylesheet' />
    <style>
        .info{
            background-color: #EED0D4;
            max-width: 50%;
            text-align: center;
            border: #b1636e 1px solid;
            padding: 0 10px 0 10px;

        }
        #main {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .city-name {
            text-align: center;
        }

        #map-container {
            display: flex;
            justify-content: center;
            align-items: center;
        }


    </style>
</head>
<body>
    <h1 class="city-name">San Antonio</h1>
    <div id="main">

    </div>
    <div>
        <input class="lat" type="text" placeholder="Latitude">
        <input class="lon" type="text" placeholder="Longitude">
        <button class="btn" type="button">Lets check the weather!</button>

    </div>

    <!--    mapbox style div-->
    <div id="map-container">
        <div id='map' style='width: 870px; height: 400px;'></div>
    </div>
<script src="js/jquery.js"></script>
<script src="js/keys.js"></script>

    <!--    mapbox js-->
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.2.1/mapbox-gl.js'></script>

<script>
    // Array of icon objects
    var icons = [{
        link: "icons/weatherIcons/SVG/Sun.svg",
        name: "clear-day"
    },
        {
            link: "icons/weatherIcons/SVG/Moon-Full.svg",
            name: "clear-night"
        },
        {
            link: "icons/weatherIcons/SVG/Cloud-Rain.svg",
            name: "rain"
        },
        {
            link: "icons/weatherIcons/SVG/Snowflake.svg",
            name: "snow"
        },
        {
            link: "icons/weatherIcons/SVG/Cloud-Hail.svg",
            name: "sleet"
        },
        {
            link: "icons/weatherIcons/SVG/Wind.svg",
            name: "wind"
        },
        {
            link: "icons/weatherIcons/SVG/Cloud-Fog.svg",
            name: "fog"
        },
        {
            link: "icons/weatherIcons/SVG/Cloud.svg",
            name: "cloudy"
        },
        {
            link: "icons/weatherIcons/SVG/Cloud-Sun.svg",
            name: "partly-cloudy-day"
        },
        {
            link: "'icons/weatherIcons/SVG/Cloud-Moon.svg",
            name: "partly-cloudy-night"
        }
    ];



    //ajax request for dark sky API

    $.get('https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/'+ darkSkyToken +'/29.4241,-98.4936').done(function(data){
        console.log(data);

        // creating html with for loop

        var html = '';

        for(var i = 0; i < 3; i++){
                html += "<div class='info'>";
                html += "<img src='" + checkIcon(icons, data.daily.data[i].icon) + "'>";
                html += "<h2>" + data.daily.data[i].temperatureMin + "째 /" + " " + data.daily.data[i].temperatureMax + "째" + "</h2>";
                html += "<p>" + "<strong>" + "Clouds: " + "</strong>"+ data.daily.data[i].summary +"</p>";
                html += "<p>" + "<strong>" + "Humidity: " + "</strong>"+ data.daily.data[i].humidity +"</p>";
                html += "<p>" + "<strong>" + "Wind: " + "</strong>"+ data.daily.data[i].windSpeed +"</p>";
                html += "<p>" + "<strong>" + "Pressure: " + "</strong>"+ data.daily.data[i].pressure +"</p>";
                html += "</div>";
            }

            $('#main').html(html);

    // this function compares my icons with the API's weather icons

        function checkIcon (icons, apiIcon) {

           for(var i = 0; i < icons.length; i++){
               if(icons[i].name === apiIcon){
                   return icons[i].link;
               }
           }
        }

    // jquery that takes in longitude and latitude inputs and plugs it into GET request

        $('.btn').click(function(){
            var inputlat = $('.lat').val();
            var inputlon = $('.lon').val();
            $.get('https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/'+ darkSkyToken + "/" + inputlat + ',' + inputlon).done(function(data) {
                console.log(data);
                var html = '';

                for(var i = 0; i < 3; i++){
                    html += "<div class='info'>";
                    html += "<img src='" + checkIcon(icons, data.daily.data[i].icon) + "'>";
                    html += "<h2>" + data.daily.data[i].temperatureMin + "째 /" + " " + data.daily.data[i].temperatureMax + "째" + "</h2>";
                    html += "<p>" + "<strong>" + "Clouds: " + "</strong>"+ data.daily.data[i].summary +"</p>";
                    html += "<p>" + "<strong>" + "Humidity: " + "</strong>"+ data.daily.data[i].humidity +"</p>";
                    html += "<p>" + "<strong>" + "Wind: " + "</strong>"+ data.daily.data[i].windSpeed +"</p>";
                    html += "<p>" + "<strong>" + "Pressure: " + "</strong>"+ data.daily.data[i].pressure +"</p>";
                    html += "</div>";
                }

                $('#main').html(html);
            });

        });

        //mapbox info

        mapboxgl.accessToken = mapBoxToken;
        var map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/streets-v9',
            zoom: 10,
            center: [-98.4916, 29.4252]

        });

        // marker for mapbox
        var marker = new mapboxgl.Marker()
            .setLngLat([-98.4916,29.4252])
            .addTo(map);

    });





</script>
</body>
</html>